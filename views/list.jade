extends layout

block content
	div(class='container')
		script(type="text/html", id="taskTemplate")
			tr
				td
					input(type='checkbox',data-bind='checked:completed,click:$parent.checkboxClicked')
				td
					<!-- ko ifnot: editActive -->
					span(class="badge badge-important", data-bind="if: $parent.isDue($data)") due
					&nbsp;
					span(data-bind="text: title")
					<!-- /ko -->
					<!-- ko if: editActive -->
					form(class='form')
						input(ID='title', data-bind='value: title',placeholder="edit title", class='input-medium')
						button(data-bind='click:function(){$parent.editTask($data)}', class='btn') Edit
					<!-- /ko -->
				td
					span(data-bind="text: points")
					span(class="glyphicon glyphicon-star")
				td
					div(class="btn-group btn-group-sm")
						button(class='btn btn-default btn-xs',type='button', data-bind='click:$parent.snoozeTaskWasClicked, visible:$parent.isDue($data)')
							span(class="glyphicon glyphicon-time")
						button(class='btn btn-default btn-xs',type='button', data-bind='click: $parent.editButtonWasClicked')
							span(class="glyphicon glyphicon-pencil")
						button(class='btn btn-default btn-xs',type='button', data-bind='click:$parent.removeTask')
							span(class="glyphicon glyphicon-remove")
					

					
		script(type="text/html", id="completeTaskTemplate")
			tr
				td
					input(type='checkbox',data-bind='checked:completed,click:$root.checkboxClicked')
				td
					span(data-bind="text: title")
				td
					span(data-bind="text: points")
					span(class="glyphicon glyphicon-star")
				td
					button(class='btn btn-xs',type='button', data-bind='click:$parent.removeTask, visible:$parent.edit')
						span(class="glyphicon glyphicon-remove")

		
		div(class='col-md-12')
			h2 Get going, do some good..
			div(class="row")
				div(class='col-md-7')
					div(class="well")
						h4 Tasks

						table(class='table table-striped')
							thead

							tbody(data-bind="template: { name: 'taskTemplate', foreach: tasks}")

				div(class="col-md-5")
					div(class="well")
						form(class='form')
							div(class="form-group")
								input(ID='title', data-bind='value: title',placeholder="New task", class='form-control')
							div(class="form-group")
								div(class="input-group")
									div(class="btn-group btn-group-sm")
										span(class="btn", data-bind="css:{'btn-default': points() !== 1, 'btn-success': points() === 1}, click: function(){self.points(1);}") 1
										span(class="btn", data-bind="css:{'btn-default': points() !== 2, 'btn-success': points() === 2}, click: function(){self.points(2);}") 2
										span(class="btn", data-bind="css:{'btn-default': points() !== 3, 'btn-success': points() === 3}, click: function(){self.points(3);}") 3
										span(class="btn", data-bind="css:{'btn-default': points() !== 5, 'btn-success': points() === 5}, click: function(){self.points(5);}") 5
										span(class="btn", data-bind="css:{'btn-default': points() !== 8, 'btn-success': points() === 8}, click: function(){self.points(8);}") 8
										span(class="btn", data-bind="css:{'btn-default': points() !== 16, 'btn-success': points() === 13}, click: function(){self.points(13);}") 13
										span(class="btn", data-bind="css:{'btn-default': points() !== 32, 'btn-success': points() === 21}, click: function(){self.points(21);}") 21
										span(class="btn", data-bind="css:{'btn-default': points() !== 64, 'btn-success': points() === 34}, click: function(){self.points(34);}") 34
										span(class="btn btn-warning glyphicon glyphicon-star", disabled="disabled")
									
							div(class="form-group")
								button(data-bind='click:function(){addTaskWasClicked()}, enable: points() && title()', class='btn') Add


			div(class="row")
				<!-- ko foreach: users() -->
				div(class="col-md-6")
					div(class="well")
						img(data-bind="attr:{src: avatar}", style="border-radius:30px;border: 1px solid #000000;float:left;margin-right: 10px;")
						span(data-bind="text: name", style="font-weight: bold;")
						br
						span(class="label label-warning glyphicon glyphicon-star",data-bind="text: $parent.getPointsForUser($data)")
						br
						br
						div(class='span6') <!--//, data-bind='visible: $parent.completedTasksMatrix()[$index].length > 0'-->	
							h5 Completed tasks
							br
							table(class='table table-striped')
								thead
								tbody(data-bind="template: { name: 'completeTaskTemplate', foreach: $parent.completedTasksMatrix()[$index()]}")
				<!-- /ko -->
	
	script(type="text/javascript")
		parameter = {"id": '#{listId}'}

	script(src='/knockout/knockout-2.2.1.debug.js', type='text/javascript')
	script(src='/js/list.js', type='text/javascript')

